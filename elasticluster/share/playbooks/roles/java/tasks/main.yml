---


- name: Add OpenJDK 8 repository to sources (Debian/Ubuntu)
  apt_repository:
    repo: ppa:openjdk-r/ppa
    state: present
  when: is_debian_compatible and java_version|int == 8


- name: Installing openjdk-jdk (Debian/Ubuntu)
  apt:
    name: openjdk-{{ java_version }}-jdk
    state: present
  when: is_debian_compatible


- name: Installing JDK (RedHat/CentOS)
  yum:
    name: java-1.{{ java_version }}.0-openjdk
    state: present
  when: is_rhel_compatible


- name: Select java version
  alternatives:
    name: java
    path: /usr/lib/jvm/java-{{ java_version }}-openjdk-amd64/bin/java


- name: Select javac version
  alternatives:
    name: javac
    path: /usr/lib/jvm/java-{{ java_version }}-openjdk-amd64/bin/javac


- name: Select jar version
  alternatives:
    name: jar
    path: /usr/lib/jvm/java-{{ java_version }}-openjdk-amd64/bin/jar


- name: Select jps version
  alternatives:
    name: jps
    path: /usr/lib/jvm/java-{{ java_version }}-openjdk-amd64/bin/jps


- name: Set default-java symlink
  file: src=/usr/lib/jvm/java-{{ java_version }}-openjdk-amd64 dest=/usr/lib/jvm/default-java state=link


- name: Set JAVA_HOME in environment
  lineinfile: dest=/etc/environment line='export JAVA_HOME=/usr/lib/jvm/default-java' insertafter='EOF' state=present
