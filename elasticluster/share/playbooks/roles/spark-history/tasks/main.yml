---


- name: Mask Spark History Server
  command: systemctl mask spark-history-server
  when: init_is_systemd


- name: Install Spark History Server
  tags:
    - hadoop
    - spark
    - hsitory
  package:
    name='{{item}}'
    state=present
  with_items:
    - spark-history-server


- name: Create Spark history dir on HDFS
  command: hdfs dfs -mkdir -p {{history_dir}}


- name: Create Spark eventlog dir on HDFS
  command: hdfs dfs -mkdir -p {{eventlog_dir}}


- name: Unmask Spark History Server
  command: systemctl unmask spark-history-server
  when: init_is_systemd


- name: Start Spark History Server
  tags:
    - hadoop
    - spark
  service:
    name="{{item}}"
    state=started
    enabled=yes
  with_items:
    - spark-history-server
