---

- name: Mesos master configuration files
  template:
    src='{{item}}.j2'
    dest='/etc/mesos-master/{{item}}'
  with_items:
    - quorum
    - hostname
    - ip

- name: Zookeeper configuration files
  template:
    src='{{item}}.j2'
    dest='/etc/zookeeper/conf/{{item}}'
  with_items:
    - myid
    - zoo.cfg

- name: Restart mesos master services
  service:
    name="{{item}}"
    state=restarted
    enabled=yes
  with_items:
    - zookeeper
    - mesos-master

- name: Spark History Server systemd service config
  template:
    src='spark-history.service.j2'
    dest='/etc/systemd/system/spark-history.service'

- name: Create local Spark History folder
  file:
    path: /tmp/spark-events
    state: directory
    owner: spark
    group: spark

- name: Start Spark History Server service
  service:
    name: spark-history
    state: started
